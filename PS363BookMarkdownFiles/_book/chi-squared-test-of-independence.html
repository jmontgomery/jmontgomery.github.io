<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Quantitative Political Methods Coursebook</title>
  <meta name="description" content="Quantitative Political Methods Coursebook">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Quantitative Political Methods Coursebook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Quantitative Political Methods Coursebook" />
  
  
  

<meta name="author" content="Jacob Montgomery">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="t-tests-in-r.html">
<link rel="next" href="lab-9-contingency-tables-in-r.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Placeholder</a></li>
<li class="chapter" data-level="2" data-path="placeholder-1.html"><a href="placeholder-1.html"><i class="fa fa-check"></i><b>2</b> Placeholder</a></li>
<li class="chapter" data-level="3" data-path="placeholder-2.html"><a href="placeholder-2.html"><i class="fa fa-check"></i><b>3</b> Placeholder</a></li>
<li class="chapter" data-level="4" data-path="placeholder-3.html"><a href="placeholder-3.html"><i class="fa fa-check"></i><b>4</b> Placeholder</a></li>
<li class="chapter" data-level="5" data-path="random-samples.html"><a href="random-samples.html"><i class="fa fa-check"></i><b>5</b> Random Samples</a></li>
<li class="chapter" data-level="6" data-path="installing-r-and-r-studio.html"><a href="installing-r-and-r-studio.html"><i class="fa fa-check"></i><b>6</b> Installing R and R Studio</a></li>
<li class="chapter" data-level="7" data-path="a-brief-introduction-to-r.html"><a href="a-brief-introduction-to-r.html"><i class="fa fa-check"></i><b>7</b> A Brief Introduction to R</a></li>
<li class="chapter" data-level="8" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html"><i class="fa fa-check"></i><b>8</b> Importing data into R</a></li>
<li class="chapter" data-level="9" data-path="visualizing-data-in-r.html"><a href="visualizing-data-in-r.html"><i class="fa fa-check"></i><b>9</b> Visualizing Data in R</a></li>
<li class="chapter" data-level="10" data-path="measures-of-position.html"><a href="measures-of-position.html"><i class="fa fa-check"></i><b>10</b> Measures of Position</a></li>
<li class="chapter" data-level="11" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html"><i class="fa fa-check"></i><b>11</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="12" data-path="measures-of-dispersion.html"><a href="measures-of-dispersion.html"><i class="fa fa-check"></i><b>12</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="13" data-path="frequency-and-probability-distributions.html"><a href="frequency-and-probability-distributions.html"><i class="fa fa-check"></i><b>13</b> Frequency and Probability Distributions</a></li>
<li class="chapter" data-level="14" data-path="some-basic-plotting-in-r.html"><a href="some-basic-plotting-in-r.html"><i class="fa fa-check"></i><b>14</b> Some basic plotting in R</a></li>
<li class="chapter" data-level="15" data-path="sampling-distributions-pt-1.html"><a href="sampling-distributions-pt-1.html"><i class="fa fa-check"></i><b>15</b> Sampling Distributions, Pt. 1</a></li>
<li class="chapter" data-level="16" data-path="sampling-distributions-pt-2.html"><a href="sampling-distributions-pt-2.html"><i class="fa fa-check"></i><b>16</b> Sampling Distributions, Pt. 2</a></li>
<li class="chapter" data-level="17" data-path="working-with-the-normal-distribution.html"><a href="working-with-the-normal-distribution.html"><i class="fa fa-check"></i><b>17</b> Working with the Normal Distribution</a></li>
<li class="chapter" data-level="18" data-path="the-binomial-distribution.html"><a href="the-binomial-distribution.html"><i class="fa fa-check"></i><b>18</b> The Binomial Distribution</a></li>
<li class="chapter" data-level="19" data-path="working-with-the-t-distribution.html"><a href="working-with-the-t-distribution.html"><i class="fa fa-check"></i><b>19</b> Working with the T-distribution</a></li>
<li class="chapter" data-level="20" data-path="placeholder-4.html"><a href="placeholder-4.html"><i class="fa fa-check"></i><b>20</b> Placeholder</a></li>
<li class="chapter" data-level="21" data-path="team-assignment.html"><a href="team-assignment.html"><i class="fa fa-check"></i><b>21</b> Team Assignment</a></li>
<li class="chapter" data-level="22" data-path="constructing-confidence-intervals-using-proportions.html"><a href="constructing-confidence-intervals-using-proportions.html"><i class="fa fa-check"></i><b>22</b> Constructing Confidence Intervals Using Proportions</a></li>
<li class="chapter" data-level="23" data-path="large-n-hypothesis-testing-for-proportions.html"><a href="large-n-hypothesis-testing-for-proportions.html"><i class="fa fa-check"></i><b>23</b> Large-n hypothesis testing for proportions</a></li>
<li class="chapter" data-level="24" data-path="type-i-and-type-ii-errors.html"><a href="type-i-and-type-ii-errors.html"><i class="fa fa-check"></i><b>24</b> Type I and Type II Errors</a></li>
<li class="chapter" data-level="25" data-path="hypothesis-testing-for-small-sample-quantitative-data.html"><a href="hypothesis-testing-for-small-sample-quantitative-data.html"><i class="fa fa-check"></i><b>25</b> Hypothesis Testing for Small Sample Quantitative Data</a></li>
<li class="chapter" data-level="26" data-path="confidence-intervals-in-r.html"><a href="confidence-intervals-in-r.html"><i class="fa fa-check"></i><b>26</b> Confidence intervals in R</a></li>
<li class="chapter" data-level="27" data-path="poster-projects.html"><a href="poster-projects.html"><i class="fa fa-check"></i><b>27</b> Poster Projects</a></li>
<li class="chapter" data-level="28" data-path="causation-and-average-treatment-effects.html"><a href="causation-and-average-treatment-effects.html"><i class="fa fa-check"></i><b>28</b> Causation and Average Treatment Effects</a></li>
<li class="chapter" data-level="29" data-path="finding-average-treatment-effects-in-r.html"><a href="finding-average-treatment-effects-in-r.html"><i class="fa fa-check"></i><b>29</b> Finding average treatment effects in R</a></li>
<li class="chapter" data-level="30" data-path="comparing-means.html"><a href="comparing-means.html"><i class="fa fa-check"></i><b>30</b> Comparing Means</a></li>
<li class="chapter" data-level="31" data-path="t-tests-in-r.html"><a href="t-tests-in-r.html"><i class="fa fa-check"></i><b>31</b> T-tests in R</a></li>
<li class="chapter" data-level="32" data-path="chi-squared-test-of-independence.html"><a href="chi-squared-test-of-independence.html"><i class="fa fa-check"></i><b>32</b> Chi Squared Test of Independence</a><ul>
<li class="chapter" data-level="32.1" data-path="chi-squared-test-of-independence.html"><a href="chi-squared-test-of-independence.html#what-is-a-chi-squared-test-of-independence"><i class="fa fa-check"></i><b>32.1</b> What is a Chi-Squared Test of Independence?</a></li>
<li class="chapter" data-level="32.2" data-path="chi-squared-test-of-independence.html"><a href="chi-squared-test-of-independence.html#performing-a-chi-squared-test-of-independence"><i class="fa fa-check"></i><b>32.2</b> Performing a Chi-Squared Test of Independence</a></li>
<li class="chapter" data-level="32.3" data-path="chi-squared-test-of-independence.html"><a href="chi-squared-test-of-independence.html#seeing-how-it-is-done"><i class="fa fa-check"></i><b>32.3</b> Seeing How it is Done!</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="lab-9-contingency-tables-in-r.html"><a href="lab-9-contingency-tables-in-r.html"><i class="fa fa-check"></i><b>33</b> Lab 9: Contingency Tables in R</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Political Methods Coursebook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chi-squared-test-of-independence" class="section level1">
<h1><span class="header-section-number">32</span> Chi Squared Test of Independence</h1>
<div id="what-is-a-chi-squared-test-of-independence" class="section level2">
<h2><span class="header-section-number">32.1</span> What is a Chi-Squared Test of Independence?</h2>
<p>When you are given a contingency table (which deals with two variables), you may want to know whether the results indicate that the two variables are related. That is, you might want to see if the two variables are independent of one another.</p>
<p>If the variables are <em>independent</em>, then a change in one should not be related with change in the other.</p>
<p>If they are <em>dependent</em>, one variable will change in concert with the other.</p>
<p>In the Chi-Squared Test, the goal is to compare the values in a contingency table that would be expected if the variables are independent with the values we actually observe. If the observed numbers differs “too much” from what we would expect if they are independent, we can reject the null hypothesis of independence.</p>
</div>
<div id="performing-a-chi-squared-test-of-independence" class="section level2">
<h2><span class="header-section-number">32.2</span> Performing a Chi-Squared Test of Independence</h2>
<ol style="list-style-type: decimal">
<li>To start, you will need a contingency table. You must have the responses tallied in each row and column with the aggregate totals for each row and column as well. Here is an example of table that looks at how age is related to preferences for hamburgers or hotdogs.</li>
</ol>
<table>
<thead>
<tr class="header">
<th>~</th>
<th>Hamburger</th>
<th>Hotdog</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Under 30</td>
<td>25</td>
<td>13</td>
<td>38</td>
</tr>
<tr class="even">
<td>Over 30</td>
<td>22</td>
<td>13</td>
<td>35</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>47</td>
<td>26</td>
<td>73</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li>Then you will need to specify your explanatory and outcome variables
<ul>
<li><em>Explanatory variable</em>: The variable that is statistically independent. For instance, in a medical experiment this might be some new drug.</li>
<li><em>Outcome variable</em>: The variables that might be statistically dependent. In experiment, for example, this would be the desease you are trying to cure. Our null hypothesis is that the distribution of the outcome variable will not change as a function of the value of the explanatory variable.</li>
</ul></li>
<li><p>Then you must calculate the <span class="math inline">\(\chi^2\)</span> statistic:</p>
<ul>
<li><p>First you must find <span class="math inline">\(f_{observed} = f_o\)</span> = observed frequency = the raw count (NOT THE %). This is the number of cases we observe in each cell of the table.</p></li>
<li><p>Then you must find <span class="math inline">\(f_{expected} = f_e\)</span>= what we would expect for independent samples. This value is equal to: <span class="math display">\[\frac{\text{Row total }\times \text{Column total}}{\text{Grand total}}\]</span></p></li>
<li><p>If the null hypothesis true, then we would expect <span class="math inline">\(f_{observed} = f_{expected}\)</span></p></li>
<li><p>The formula for the <span class="math inline">\(\chi^2\)</span> measures the degree to which our obsrerved data differs from what we would expect under the null. Specifically, <span class="math display">\[\chi^2 = \sum\frac{(f_0-f_e)^2}{f_e}\]</span> Note that we summing over all cells in the table.</p></li>
</ul></li>
<li><p>A few comments on <span class="math inline">\(\chi^2\)</span>:</p>
<ul>
<li><p>If the samples are truly independent, <span class="math inline">\(\chi^2 \rightarrow 0\)</span>.</p></li>
<li><p>If they are actually dependent, <span class="math inline">\(\chi^2 \rightarrow \infty\)</span></p></li>
<li><p>This statistic is distributed according to the <span class="math inline">\(\chi^2\)</span> distribution. And we will use that to calculate p-values.</p></li>
<li><p>YOU WILL ALWAYS HAVE A POSITIVE NUMBER.</p></li>
</ul></li>
<li><p>Once you get the <span class="math inline">\(\chi^2\)</span> statistic you must find the Degrees of Freedom to calcualte the p-value.</p>
<ul>
<li><p>DF= (rows - 1)(columns - 1)</p></li>
<li><p>In R, the code is: pchisq(<span class="math inline">\(\chi^2\)</span>, df = (rows-1)(columns-1), lower.tail=FALSE)</p></li>
<li><p>Use this table for exams.</p></li>
</ul></li>
<li><p>Conclusion</p>
<ul>
<li>If your P-value is greater than your <span class="math inline">\(\alpha\)</span>, you will fail to reject the null hypothesis. If it is less than your <span class="math inline">\(\alpha\)</span>, you will reject the null hypothesis.</li>
</ul></li>
</ol>
</div>
<div id="seeing-how-it-is-done" class="section level2">
<h2><span class="header-section-number">32.3</span> Seeing How it is Done!</h2>
<p>First let’s pose a question: Is age independent of preference between hamburgers and hotdogs</p>
<p>Now, let’s look at a chart which gives responses for an actual example. Here is the contingency table from above.</p>
<table>
<thead>
<tr class="header">
<th>~</th>
<th>Hamburger</th>
<th>Hotdog</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Under 30</td>
<td>25</td>
<td>13</td>
<td>38</td>
</tr>
<tr class="even">
<td>Over 30</td>
<td>22</td>
<td>13</td>
<td>35</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>47</td>
<td>26</td>
<td>73</td>
</tr>
</tbody>
</table>
<p>Now let’s get Null and Alternative Hypotheses:</p>
<p><em>Null</em>: Age has no impact on preference between Hotdogs and Hamburgers Alternative: Age does have an impact on preference between Hotdogs and Hamburgers</p>
<p>From there, it is time to calculate the Chi Squared statistic</p>
<p>First, you must calculate the expected (<span class="math inline">\(f_e\)</span>) values for each of the cells using the following formula above. You calculate it for all of the “response” cells. The <span class="math inline">\(f_e\)</span> for each cell are provided in each cell in parenthesis.</p>
<table>
<thead>
<tr class="header">
<th>~</th>
<th>Hamburger</th>
<th>Hotdog</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Under 30</td>
<td>25(24.5)</td>
<td>13(13.5)</td>
<td>38</td>
</tr>
<tr class="even">
<td>Over 30</td>
<td>22(22.5)</td>
<td>13(12.5)</td>
<td>35</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>47</td>
<td>26</td>
<td>73</td>
</tr>
</tbody>
</table>
<p>Second, you must calculate chi squared statistic with the following formula:</p>
<p><span class="math display">\[\chi^2 = \sum\frac{(f_0-f_e)^2}{f_e}\]</span></p>
<p>If you do the calculation, you should find 0.061</p>
<p>Now you need the degrees of freedom. DF= (Row-1)<em>(Column-1)=(2-1)</em>(2-1)=1</p>
<p>Note: You might be tempted to say that the # of rows=4 and the # of columns=4. However, we are not looking for the total number of rows and columns in the table, just the number of rows and tables for the “response” cells!</p>
<p>Now you calculate the p-value: Given the test statistic of 0.061 and df=1, P-value should come out to around 0.8. This is a very high p-value, and therefore you will fail to reject the null hypothesis, and therefore age does not seem to be related to hamburger/hotdog preference.</p>
<p>Below is a video, which will take you through the same type of calculations that were performed above</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/hpWdDmgsIRE" frameborder="0" allowfullscreen>
</iframe>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="t-tests-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lab-9-contingency-tables-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
